using Ardalis.Specification.EntityFrameworkCore;
using Garen.MultiTenant.Service.Admin.Specifications;
using Garen.MultiTenant.Core.Entities;
using Garen.MultiTenant.Core.Extensions;
using Garen.MultiTenant.Infrastructure.Database.DbContexts;
using Microsoft.EntityFrameworkCore;

namespace Garen.MultiTenant.Service.Admin
{
    public partial class SysTestService : RepositoryBase<SysTest>
    {
        private readonly ApplicationDbContext _context;

        public SysTestService(ApplicationDbContext context) : base(context)
        {
            _context = context;
        }
        public async Task<List<SysTest>> GetPage(SysTest test)
        {
            var spec = new SysTestSpecification(test);
            return await ApplySpecification(spec).StartPage(test).ToListAsync();
        }
        public async Task<List<SysTest>> GetPage(int pageNum,int pageSize)
        {
            return await _context.SysTest.StartPage(pageNum,pageSize).ToListAsync();
        }
        public async Task DeleteRange(long [] ids)
        {
            var tests = await _context.SysTest.Where(x=>ids.Contains(x.TestId)).ToListAsync();
            await DeleteRangeAsync(tests);
        }
    }

}
